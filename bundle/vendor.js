import{g as ht}from"./__commonjsHelpers__.js";var Re={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(a,c,u){this.fn=a,this.context=c,this.once=u||!1}function i(a,c,u,f,g){if(typeof u!="function")throw new TypeError("The listener must be a function");var m=new s(u,f||a,g),d=n?n+c:c;return a._events[d]?a._events[d].fn?a._events[d]=[a._events[d],m]:a._events[d].push(m):(a._events[d]=m,a._eventsCount++),a}function o(a,c){--a._eventsCount===0?a._events=new r:delete a._events[c]}function l(){this._events=new r,this._eventsCount=0}l.prototype.eventNames=function(){var c=[],u,f;if(this._eventsCount===0)return c;for(f in u=this._events)e.call(u,f)&&c.push(n?f.slice(1):f);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},l.prototype.listeners=function(c){var u=n?n+c:c,f=this._events[u];if(!f)return[];if(f.fn)return[f.fn];for(var g=0,m=f.length,d=new Array(m);g<m;g++)d[g]=f[g].fn;return d},l.prototype.listenerCount=function(c){var u=n?n+c:c,f=this._events[u];return f?f.fn?1:f.length:0},l.prototype.emit=function(c,u,f,g,m,d){var w=n?n+c:c;if(!this._events[w])return!1;var h=this._events[w],_=arguments.length,y,b;if(h.fn){switch(h.once&&this.removeListener(c,h.fn,void 0,!0),_){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,u),!0;case 3:return h.fn.call(h.context,u,f),!0;case 4:return h.fn.call(h.context,u,f,g),!0;case 5:return h.fn.call(h.context,u,f,g,m),!0;case 6:return h.fn.call(h.context,u,f,g,m,d),!0}for(b=1,y=new Array(_-1);b<_;b++)y[b-1]=arguments[b];h.fn.apply(h.context,y)}else{var ut=h.length,N;for(b=0;b<ut;b++)switch(h[b].once&&this.removeListener(c,h[b].fn,void 0,!0),_){case 1:h[b].fn.call(h[b].context);break;case 2:h[b].fn.call(h[b].context,u);break;case 3:h[b].fn.call(h[b].context,u,f);break;case 4:h[b].fn.call(h[b].context,u,f,g);break;default:if(!y)for(N=1,y=new Array(_-1);N<_;N++)y[N-1]=arguments[N];h[b].fn.apply(h[b].context,y)}}return!0},l.prototype.on=function(c,u,f){return i(this,c,u,f,!1)},l.prototype.once=function(c,u,f){return i(this,c,u,f,!0)},l.prototype.removeListener=function(c,u,f,g){var m=n?n+c:c;if(!this._events[m])return this;if(!u)return o(this,m),this;var d=this._events[m];if(d.fn)d.fn===u&&(!g||d.once)&&(!f||d.context===f)&&o(this,m);else{for(var w=0,h=[],_=d.length;w<_;w++)(d[w].fn!==u||g&&!d[w].once||f&&d[w].context!==f)&&h.push(d[w]);h.length?this._events[m]=h.length===1?h[0]:h:o(this,m)}return this},l.prototype.removeAllListeners=function(c){var u;return c?(u=n?n+c:c,this._events[u]&&o(this,u)):(this._events=new r,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=n,l.EventEmitter=l,t.exports=l})(Re);var ft=Re.exports;const hs=ht(ft);const Fe=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},dt=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],a=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(a>>10)),e[r++]=String.fromCharCode(56320+(a&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Le={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,a=s+2<t.length,c=a?t[s+2]:0,u=i>>2,f=(i&3)<<4|l>>4;let g=(l&15)<<2|c>>6,m=c&63;a||(m=64,o||(g=64)),r.push(n[u],n[f],n[g],n[m])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Fe(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):dt(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const c=s<t.length?n[t.charAt(s)]:64;++s;const f=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||c==null||f==null)throw new gt;const g=i<<2|l>>4;if(r.push(g),c!==64){const m=l<<4&240|c>>2;if(r.push(m),f!==64){const d=c<<6&192|f;r.push(d)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class gt extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const pt=function(t){const e=Fe(t);return Le.encodeByteArray(e,!0)},Pe=function(t){return pt(t).replace(/\./g,"")},mt=function(t){try{return Le.decodeString(t,!0)}catch{}return null};function bt(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const _t=()=>bt().__FIREBASE_DEFAULTS__,wt=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Et=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&mt(t[1]);return e&&JSON.parse(e)},yt=()=>{try{return _t()||wt()||Et()}catch{return}},Ne=()=>{var t;return(t=yt())===null||t===void 0?void 0:t.config};class It{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}function $e(){try{return typeof indexedDB=="object"}catch{return!1}}function St(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}const Ct="FirebaseError";class T extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Ct,Object.setPrototypeOf(this,T.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,V.prototype.create)}}class V{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?vt(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new T(s,l,r)}}function vt(t,e){return t.replace(Tt,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Tt=/\{\$([^}]+)}/g;function te(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(be(i)&&be(o)){if(!te(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function be(t){return t!==null&&typeof t=="object"}const At=1e3,Dt=2,Mt=4*60*60*1e3,Ot=.5;function Bt(t,e=At,n=Dt){const r=e*Math.pow(n,t),s=Math.round(Ot*r*(Math.random()-.5)*2);return Math.min(Mt,r+s)}function L(t){return t&&t._delegate?t._delegate:t}class O{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const A="[DEFAULT]";class Rt{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new It;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Lt(e))try{this.getOrInitializeService({instanceIdentifier:A})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=A){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=A){return this.instances.has(e)}getOptions(e=A){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Ft(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=A){return this.component?this.component.multipleInstances?e:A:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Ft(t){return t===A?void 0:t}function Lt(t){return t.instantiationMode==="EAGER"}class Pt{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Rt(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var p;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(p||(p={}));const Nt={debug:p.DEBUG,verbose:p.VERBOSE,info:p.INFO,warn:p.WARN,error:p.ERROR,silent:p.SILENT},$t=p.INFO,kt={[p.DEBUG]:"log",[p.VERBOSE]:"log",[p.INFO]:"info",[p.WARN]:"warn",[p.ERROR]:"error"},xt=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=kt[e];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ke{constructor(e){this.name=e,this._logLevel=$t,this._logHandler=xt,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in p))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Nt[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,p.DEBUG,...e),this._logHandler(this,p.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,p.VERBOSE,...e),this._logHandler(this,p.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,p.INFO,...e),this._logHandler(this,p.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,p.WARN,...e),this._logHandler(this,p.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,p.ERROR,...e),this._logHandler(this,p.ERROR,...e)}}const jt=(t,e)=>e.some(n=>t instanceof n);let _e,we;function Vt(){return _e||(_e=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Ht(){return we||(we=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const xe=new WeakMap,ne=new WeakMap,je=new WeakMap,z=new WeakMap,ue=new WeakMap;function Ut(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(I(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&xe.set(n,t)}).catch(()=>{}),ue.set(e,t),e}function zt(t){if(ne.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});ne.set(t,e)}let re={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return ne.get(t);if(e==="objectStoreNames")return t.objectStoreNames||je.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return I(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Wt(t){re=t(re)}function Kt(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(W(this),e,...n);return je.set(r,e.sort?e.sort():[e]),I(r)}:Ht().includes(t)?function(...e){return t.apply(W(this),e),I(xe.get(this))}:function(...e){return I(t.apply(W(this),e))}}function qt(t){return typeof t=="function"?Kt(t):(t instanceof IDBTransaction&&zt(t),jt(t,Vt())?new Proxy(t,re):t)}function I(t){if(t instanceof IDBRequest)return Ut(t);if(z.has(t))return z.get(t);const e=qt(t);return e!==t&&(z.set(t,e),ue.set(e,t)),e}const W=t=>ue.get(t);function Gt(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=I(o);return r&&o.addEventListener("upgradeneeded",a=>{r(I(o.result),a.oldVersion,a.newVersion,I(o.transaction),a)}),n&&o.addEventListener("blocked",a=>n(a.oldVersion,a.newVersion,a)),l.then(a=>{i&&a.addEventListener("close",()=>i()),s&&a.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),l}const Jt=["get","getKey","getAll","getAllKeys","count"],Yt=["put","add","delete","clear"],K=new Map;function Ee(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(K.get(e))return K.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=Yt.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Jt.includes(n)))return;const i=async function(o,...l){const a=this.transaction(o,s?"readwrite":"readonly");let c=a.store;return r&&(c=c.index(l.shift())),(await Promise.all([c[n](...l),s&&a.done]))[0]};return K.set(e,i),i}Wt(t=>({...t,get:(e,n,r)=>Ee(e,n)||t.get(e,n,r),has:(e,n)=>!!Ee(e,n)||t.has(e,n)}));class Xt{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Zt(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function Zt(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const se="@firebase/app",ye="0.9.20";const B=new ke("@firebase/app"),Qt="@firebase/app-compat",en="@firebase/analytics-compat",tn="@firebase/analytics",nn="@firebase/app-check-compat",rn="@firebase/app-check",sn="@firebase/auth",on="@firebase/auth-compat",an="@firebase/database",cn="@firebase/database-compat",ln="@firebase/functions",un="@firebase/functions-compat",hn="@firebase/installations",fn="@firebase/installations-compat",dn="@firebase/messaging",gn="@firebase/messaging-compat",pn="@firebase/performance",mn="@firebase/performance-compat",bn="@firebase/remote-config",_n="@firebase/remote-config-compat",wn="@firebase/storage",En="@firebase/storage-compat",yn="@firebase/firestore",In="@firebase/firestore-compat",Sn="firebase",Cn="10.5.0";const ie="[DEFAULT]",vn={[se]:"fire-core",[Qt]:"fire-core-compat",[tn]:"fire-analytics",[en]:"fire-analytics-compat",[rn]:"fire-app-check",[nn]:"fire-app-check-compat",[sn]:"fire-auth",[on]:"fire-auth-compat",[an]:"fire-rtdb",[cn]:"fire-rtdb-compat",[ln]:"fire-fn",[un]:"fire-fn-compat",[hn]:"fire-iid",[fn]:"fire-iid-compat",[dn]:"fire-fcm",[gn]:"fire-fcm-compat",[pn]:"fire-perf",[mn]:"fire-perf-compat",[bn]:"fire-rc",[_n]:"fire-rc-compat",[wn]:"fire-gcs",[En]:"fire-gcs-compat",[yn]:"fire-fst",[In]:"fire-fst-compat","fire-js":"fire-js",[Sn]:"fire-js-all"};const x=new Map,oe=new Map;function Tn(t,e){try{t.container.addComponent(e)}catch(n){B.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function P(t){const e=t.name;if(oe.has(e))return B.debug(`There were multiple attempts to register component ${e}.`),!1;oe.set(e,t);for(const n of x.values())Tn(n,t);return!0}function he(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}const An={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},S=new V("app","Firebase",An);class Dn{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new O("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw S.create("app-deleted",{appName:this._name})}}const Mn=Cn;function On(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:ie,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw S.create("bad-app-name",{appName:String(s)});if(n||(n=Ne()),!n)throw S.create("no-options");const i=x.get(s);if(i){if(te(n,i.options)&&te(r,i.config))return i;throw S.create("duplicate-app",{appName:s})}const o=new Pt(s);for(const a of oe.values())o.addComponent(a);const l=new Dn(n,r,o);return x.set(s,l),l}function Bn(t=ie){const e=x.get(t);if(!e&&t===ie&&Ne())return On();if(!e)throw S.create("no-app",{appName:t});return e}function C(t,e,n){var r;let s=(r=vn[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),B.warn(l.join(" "));return}P(new O(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}const Rn="firebase-heartbeat-database",Fn=1,$="firebase-heartbeat-store";let q=null;function Ve(){return q||(q=Gt(Rn,Fn,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore($)}}}).catch(t=>{throw S.create("idb-open",{originalErrorMessage:t.message})})),q}async function Ln(t){try{return await(await Ve()).transaction($).objectStore($).get(He(t))}catch(e){if(e instanceof T)B.warn(e.message);else{const n=S.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});B.warn(n.message)}}}async function Ie(t,e){try{const r=(await Ve()).transaction($,"readwrite");await r.objectStore($).put(e,He(t)),await r.done}catch(n){if(n instanceof T)B.warn(n.message);else{const r=S.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});B.warn(r.message)}}}function He(t){return`${t.name}!${t.options.appId}`}const Pn=1024,Nn=30*24*60*60*1e3;class $n{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new xn(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Se();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const i=new Date(s.date).valueOf();return Date.now()-i<=Nn}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Se(),{heartbeatsToSend:n,unsentEntries:r}=kn(this._heartbeatsCache.heartbeats),s=Pe(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function Se(){return new Date().toISOString().substring(0,10)}function kn(t,e=Pn){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Ce(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Ce(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class xn{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return $e()?St().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await Ln(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Ie(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Ie(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Ce(t){return Pe(JSON.stringify({version:2,heartbeats:t})).length}function jn(t){P(new O("platform-logger",e=>new Xt(e),"PRIVATE")),P(new O("heartbeat",e=>new $n(e),"PRIVATE")),C(se,ye,t),C(se,ye,"esm2017"),C("fire-js","")}jn("");var Vn="firebase",Hn="10.5.0";C(Vn,Hn,"app");const Un=(t,e)=>e.some(n=>t instanceof n);let ve,Te;function zn(){return ve||(ve=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Wn(){return Te||(Te=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Ue=new WeakMap,ae=new WeakMap,ze=new WeakMap,G=new WeakMap,fe=new WeakMap;function Kn(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(v(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Ue.set(n,t)}).catch(()=>{}),fe.set(e,t),e}function qn(t){if(ae.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});ae.set(t,e)}let ce={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return ae.get(t);if(e==="objectStoreNames")return t.objectStoreNames||ze.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return v(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Gn(t){ce=t(ce)}function Jn(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(J(this),e,...n);return ze.set(r,e.sort?e.sort():[e]),v(r)}:Wn().includes(t)?function(...e){return t.apply(J(this),e),v(Ue.get(this))}:function(...e){return v(t.apply(J(this),e))}}function Yn(t){return typeof t=="function"?Jn(t):(t instanceof IDBTransaction&&qn(t),Un(t,zn())?new Proxy(t,ce):t)}function v(t){if(t instanceof IDBRequest)return Kn(t);if(G.has(t))return G.get(t);const e=Yn(t);return e!==t&&(G.set(t,e),fe.set(e,t)),e}const J=t=>fe.get(t);function Xn(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=v(o);return r&&o.addEventListener("upgradeneeded",a=>{r(v(o.result),a.oldVersion,a.newVersion,v(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),l.then(a=>{i&&a.addEventListener("close",()=>i()),s&&a.addEventListener("versionchange",()=>s())}).catch(()=>{}),l}const Zn=["get","getKey","getAll","getAllKeys","count"],Qn=["put","add","delete","clear"],Y=new Map;function Ae(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Y.get(e))return Y.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=Qn.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Zn.includes(n)))return;const i=async function(o,...l){const a=this.transaction(o,s?"readwrite":"readonly");let c=a.store;return r&&(c=c.index(l.shift())),(await Promise.all([c[n](...l),s&&a.done]))[0]};return Y.set(e,i),i}Gn(t=>({...t,get:(e,n,r)=>Ae(e,n)||t.get(e,n,r),has:(e,n)=>!!Ae(e,n)||t.has(e,n)}));const We="@firebase/installations",de="0.6.4";const Ke=1e4,qe=`w:${de}`,Ge="FIS_v2",er="https://firebaseinstallations.googleapis.com/v1",tr=60*60*1e3,nr="installations",rr="Installations";const sr={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},R=new V(nr,rr,sr);function Je(t){return t instanceof T&&t.code.includes("request-failed")}function Ye({projectId:t}){return`${er}/projects/${t}/installations`}function Xe(t){return{token:t.token,requestStatus:2,expiresIn:or(t.expiresIn),creationTime:Date.now()}}async function Ze(t,e){const r=(await e.json()).error;return R.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function Qe({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function ir(t,{refreshToken:e}){const n=Qe(t);return n.append("Authorization",ar(e)),n}async function et(t){const e=await t();return e.status>=500&&e.status<600?t():e}function or(t){return Number(t.replace("s","000"))}function ar(t){return`${Ge} ${t}`}async function cr({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=Ye(t),s=Qe(t),i=e.getImmediate({optional:!0});if(i){const c=await i.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const o={fid:n,authVersion:Ge,appId:t.appId,sdkVersion:qe},l={method:"POST",headers:s,body:JSON.stringify(o)},a=await et(()=>fetch(r,l));if(a.ok){const c=await a.json();return{fid:c.fid||n,registrationStatus:2,refreshToken:c.refreshToken,authToken:Xe(c.authToken)}}else throw await Ze("Create Installation",a)}function tt(t){return new Promise(e=>{setTimeout(e,t)})}function lr(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}const ur=/^[cdef][\w-]{21}$/,le="";function hr(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=fr(t);return ur.test(n)?n:le}catch{return le}}function fr(t){return lr(t).substr(0,22)}function H(t){return`${t.appName}!${t.appId}`}const nt=new Map;function rt(t,e){const n=H(t);st(n,e),dr(n,e)}function st(t,e){const n=nt.get(t);if(n)for(const r of n)r(e)}function dr(t,e){const n=gr();n&&n.postMessage({key:t,fid:e}),pr()}let M=null;function gr(){return!M&&"BroadcastChannel"in self&&(M=new BroadcastChannel("[Firebase] FID Change"),M.onmessage=t=>{st(t.data.key,t.data.fid)}),M}function pr(){nt.size===0&&M&&(M.close(),M=null)}const mr="firebase-installations-database",br=1,F="firebase-installations-store";let X=null;function ge(){return X||(X=Xn(mr,br,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(F)}}})),X}async function j(t,e){const n=H(t),s=(await ge()).transaction(F,"readwrite"),i=s.objectStore(F),o=await i.get(n);return await i.put(e,n),await s.done,(!o||o.fid!==e.fid)&&rt(t,e.fid),e}async function it(t){const e=H(t),r=(await ge()).transaction(F,"readwrite");await r.objectStore(F).delete(e),await r.done}async function U(t,e){const n=H(t),s=(await ge()).transaction(F,"readwrite"),i=s.objectStore(F),o=await i.get(n),l=e(o);return l===void 0?await i.delete(n):await i.put(l,n),await s.done,l&&(!o||o.fid!==l.fid)&&rt(t,l.fid),l}async function pe(t){let e;const n=await U(t.appConfig,r=>{const s=_r(r),i=wr(t,s);return e=i.registrationPromise,i.installationEntry});return n.fid===le?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function _r(t){const e=t||{fid:hr(),registrationStatus:0};return ot(e)}function wr(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(R.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=Er(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:yr(t)}:{installationEntry:e}}async function Er(t,e){try{const n=await cr(t,e);return j(t.appConfig,n)}catch(n){throw Je(n)&&n.customData.serverCode===409?await it(t.appConfig):await j(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function yr(t){let e=await De(t.appConfig);for(;e.registrationStatus===1;)await tt(100),e=await De(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await pe(t);return r||n}return e}function De(t){return U(t,e=>{if(!e)throw R.create("installation-not-found");return ot(e)})}function ot(t){return Ir(t)?{fid:t.fid,registrationStatus:0}:t}function Ir(t){return t.registrationStatus===1&&t.registrationTime+Ke<Date.now()}async function Sr({appConfig:t,heartbeatServiceProvider:e},n){const r=Cr(t,n),s=ir(t,n),i=e.getImmediate({optional:!0});if(i){const c=await i.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const o={installation:{sdkVersion:qe,appId:t.appId}},l={method:"POST",headers:s,body:JSON.stringify(o)},a=await et(()=>fetch(r,l));if(a.ok){const c=await a.json();return Xe(c)}else throw await Ze("Generate Auth Token",a)}function Cr(t,{fid:e}){return`${Ye(t)}/${e}/authTokens:generate`}async function me(t,e=!1){let n;const r=await U(t.appConfig,i=>{if(!at(i))throw R.create("not-registered");const o=i.authToken;if(!e&&Ar(o))return i;if(o.requestStatus===1)return n=vr(t,e),i;{if(!navigator.onLine)throw R.create("app-offline");const l=Mr(i);return n=Tr(t,l),l}});return n?await n:r.authToken}async function vr(t,e){let n=await Me(t.appConfig);for(;n.authToken.requestStatus===1;)await tt(100),n=await Me(t.appConfig);const r=n.authToken;return r.requestStatus===0?me(t,e):r}function Me(t){return U(t,e=>{if(!at(e))throw R.create("not-registered");const n=e.authToken;return Or(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function Tr(t,e){try{const n=await Sr(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await j(t.appConfig,r),n}catch(n){if(Je(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await it(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await j(t.appConfig,r)}throw n}}function at(t){return t!==void 0&&t.registrationStatus===2}function Ar(t){return t.requestStatus===2&&!Dr(t)}function Dr(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+tr}function Mr(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function Or(t){return t.requestStatus===1&&t.requestTime+Ke<Date.now()}async function Br(t){const e=t,{installationEntry:n,registrationPromise:r}=await pe(e);return r?r.catch(console.error):me(e).catch(console.error),n.fid}async function Rr(t,e=!1){const n=t;return await Fr(n),(await me(n,e)).token}async function Fr(t){const{registrationPromise:e}=await pe(t);e&&await e}function Lr(t){if(!t||!t.options)throw Z("App Configuration");if(!t.name)throw Z("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Z(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Z(t){return R.create("missing-app-config-values",{valueName:t})}const ct="installations",Pr="installations-internal",Nr=t=>{const e=t.getProvider("app").getImmediate(),n=Lr(e),r=he(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},$r=t=>{const e=t.getProvider("app").getImmediate(),n=he(e,ct).getImmediate();return{getId:()=>Br(n),getToken:s=>Rr(n,s)}};function kr(){P(new O(ct,Nr,"PUBLIC")),P(new O(Pr,$r,"PRIVATE"))}kr();C(We,de);C(We,de,"esm2017");const Q="@firebase/remote-config",Oe="0.4.4";class xr{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}const lt="remote-config";const jr={"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"},E=new V("remoteconfig","Remote Config",jr);function Vr(t,e){return t instanceof T&&t.code.indexOf(e)!==-1}const Hr=!1,Ur="",Be=0,zr=["1","true","t","yes","y","on"];class ee{constructor(e,n=Ur){this._source=e,this._value=n}asString(){return this._value}asBoolean(){return this._source==="static"?Hr:zr.indexOf(this._value.toLowerCase())>=0}asNumber(){if(this._source==="static")return Be;let e=Number(this._value);return isNaN(e)&&(e=Be),e}getSource(){return this._source}}function fs(t=Bn()){return t=L(t),he(t,lt).getImmediate()}async function Wr(t){const e=L(t),[n,r]=await Promise.all([e._storage.getLastSuccessfulFetchResponse(),e._storage.getActiveConfigEtag()]);return!n||!n.config||!n.eTag||n.eTag===r?!1:(await Promise.all([e._storageCache.setActiveConfig(n.config),e._storage.setActiveConfigEtag(n.eTag)]),!0)}function Kr(t){const e=L(t);return e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0})),e._initializePromise}async function qr(t){const e=L(t),n=new xr;setTimeout(async()=>{n.abort()},e.settings.fetchTimeoutMillis);try{await e._client.fetch({cacheMaxAgeMillis:e.settings.minimumFetchIntervalMillis,signal:n}),await e._storageCache.setLastFetchStatus("success")}catch(r){const s=Vr(r,"fetch-throttle")?"throttle":"failure";throw await e._storageCache.setLastFetchStatus(s),r}}function ds(t,e){return Gr(L(t),e).asString()}function Gr(t,e){const n=L(t);n._isInitializationComplete||n._logger.debug(`A value was requested for key "${e}" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.`);const r=n._storageCache.getActiveConfig();return r&&r[e]!==void 0?new ee("remote",r[e]):n.defaultConfig&&n.defaultConfig[e]!==void 0?new ee("default",String(n.defaultConfig[e])):(n._logger.debug(`Returning static value for key "${e}". Define a default or remote value if this is unintentional.`),new ee("static"))}class Jr{constructor(e,n,r,s){this.client=e,this.storage=n,this.storageCache=r,this.logger=s}isCachedDataFresh(e,n){if(!n)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const r=Date.now()-n,s=r<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${r}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${s}.`),s}async fetch(e){const[n,r]=await Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()]);if(r&&this.isCachedDataFresh(e.cacheMaxAgeMillis,n))return r;e.eTag=r&&r.eTag;const s=await this.client.fetch(e),i=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return s.status===200&&i.push(this.storage.setLastSuccessfulFetchResponse(s)),await Promise.all(i),s}}function Yr(t=navigator){return t.languages&&t.languages[0]||t.language}class Xr{constructor(e,n,r,s,i,o){this.firebaseInstallations=e,this.sdkVersion=n,this.namespace=r,this.projectId=s,this.apiKey=i,this.appId=o}async fetch(e){const[n,r]=await Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()]),i=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${this.projectId}/namespaces/${this.namespace}:fetch?key=${this.apiKey}`,o={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},l={sdk_version:this.sdkVersion,app_instance_id:n,app_instance_id_token:r,app_id:this.appId,language_code:Yr()},a={method:"POST",headers:o,body:JSON.stringify(l)},c=fetch(i,a),u=new Promise((h,_)=>{e.signal.addEventListener(()=>{const y=new Error("The operation was aborted.");y.name="AbortError",_(y)})});let f;try{await Promise.race([c,u]),f=await c}catch(h){let _="fetch-client-network";throw(h==null?void 0:h.name)==="AbortError"&&(_="fetch-timeout"),E.create(_,{originalErrorMessage:h==null?void 0:h.message})}let g=f.status;const m=f.headers.get("ETag")||void 0;let d,w;if(f.status===200){let h;try{h=await f.json()}catch(_){throw E.create("fetch-client-parse",{originalErrorMessage:_==null?void 0:_.message})}d=h.entries,w=h.state}if(w==="INSTANCE_STATE_UNSPECIFIED"?g=500:w==="NO_CHANGE"?g=304:(w==="NO_TEMPLATE"||w==="EMPTY_CONFIG")&&(d={}),g!==304&&g!==200)throw E.create("fetch-status",{httpStatus:g});return{status:g,eTag:m,config:d}}}function Zr(t,e){return new Promise((n,r)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(n,s);t.addEventListener(()=>{clearTimeout(i),r(E.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function Qr(t){if(!(t instanceof T)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class es{constructor(e,n){this.client=e,this.storage=n}async fetch(e){const n=await this.storage.getThrottleMetadata()||{backoffCount:0,throttleEndTimeMillis:Date.now()};return this.attemptFetch(e,n)}async attemptFetch(e,{throttleEndTimeMillis:n,backoffCount:r}){await Zr(e.signal,n);try{const s=await this.client.fetch(e);return await this.storage.deleteThrottleMetadata(),s}catch(s){if(!Qr(s))throw s;const i={throttleEndTimeMillis:Date.now()+Bt(r),backoffCount:r+1};return await this.storage.setThrottleMetadata(i),this.attemptFetch(e,i)}}}const ts=60*1e3,ns=12*60*60*1e3;class rs{constructor(e,n,r,s,i){this.app=e,this._client=n,this._storageCache=r,this._storage=s,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:ts,minimumFetchIntervalMillis:ns},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function k(t,e){const n=t.target.error||void 0;return E.create(e,{originalErrorMessage:n&&(n==null?void 0:n.message)})}const D="app_namespace_store",ss="firebase_remote_config",is=1;function os(){return new Promise((t,e)=>{try{const n=indexedDB.open(ss,is);n.onerror=r=>{e(k(r,"storage-open"))},n.onsuccess=r=>{t(r.target.result)},n.onupgradeneeded=r=>{const s=r.target.result;switch(r.oldVersion){case 0:s.createObjectStore(D,{keyPath:"compositeKey"})}}}catch(n){e(E.create("storage-open",{originalErrorMessage:n==null?void 0:n.message}))}})}class as{constructor(e,n,r,s=os()){this.appId=e,this.appName=n,this.namespace=r,this.openDbPromise=s}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}async get(e){const n=await this.openDbPromise;return new Promise((r,s)=>{const o=n.transaction([D],"readonly").objectStore(D),l=this.createCompositeKey(e);try{const a=o.get(l);a.onerror=c=>{s(k(c,"storage-get"))},a.onsuccess=c=>{const u=c.target.result;r(u?u.value:void 0)}}catch(a){s(E.create("storage-get",{originalErrorMessage:a==null?void 0:a.message}))}})}async set(e,n){const r=await this.openDbPromise;return new Promise((s,i)=>{const l=r.transaction([D],"readwrite").objectStore(D),a=this.createCompositeKey(e);try{const c=l.put({compositeKey:a,value:n});c.onerror=u=>{i(k(u,"storage-set"))},c.onsuccess=()=>{s()}}catch(c){i(E.create("storage-set",{originalErrorMessage:c==null?void 0:c.message}))}})}async delete(e){const n=await this.openDbPromise;return new Promise((r,s)=>{const o=n.transaction([D],"readwrite").objectStore(D),l=this.createCompositeKey(e);try{const a=o.delete(l);a.onerror=c=>{s(k(c,"storage-delete"))},a.onsuccess=()=>{r()}}catch(a){s(E.create("storage-delete",{originalErrorMessage:a==null?void 0:a.message}))}})}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}class cs{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}async loadFromStorage(){const e=this.storage.getLastFetchStatus(),n=this.storage.getLastSuccessfulFetchTimestampMillis(),r=this.storage.getActiveConfig(),s=await e;s&&(this.lastFetchStatus=s);const i=await n;i&&(this.lastSuccessfulFetchTimestampMillis=i);const o=await r;o&&(this.activeConfig=o)}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}function ls(){P(new O(lt,t,"PUBLIC").setMultipleInstances(!0)),C(Q,Oe),C(Q,Oe,"esm2017");function t(e,{instanceIdentifier:n}){const r=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw E.create("registration-window");if(!$e())throw E.create("indexed-db-unavailable");const{projectId:i,apiKey:o,appId:l}=r.options;if(!i)throw E.create("registration-project-id");if(!o)throw E.create("registration-api-key");if(!l)throw E.create("registration-app-id");n=n||"firebase";const a=new as(l,r.name,n),c=new cs(a),u=new ke(Q);u.logLevel=p.ERROR;const f=new Xr(s,Mn,n,i,o,l),g=new es(f,a),m=new Jr(g,a,c,u),d=new rs(r,m,c,a,u);return Kr(d),d}}async function gs(t){return t=L(t),await qr(t),Wr(t)}ls();export{hs as E,ds as a,gs as f,fs as g,On as i};
