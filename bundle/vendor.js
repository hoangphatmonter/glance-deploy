var qt=Object.defineProperty;var i=(t,e)=>qt(t,"name",{value:e,configurable:!0});import{g as Gt}from"./__commonjsHelpers__.js";var De={exports:{}};De.exports;(function(t){var e=Object.prototype.hasOwnProperty,n="~";function s(){}i(s,"Events"),Object.create&&(s.prototype=Object.create(null),new s().__proto__||(n=!1));function r(c,u,h){this.fn=c,this.context=u,this.once=h||!1}i(r,"EE");function o(c,u,h,d,p){if(typeof h!="function")throw new TypeError("The listener must be a function");var b=new r(h,d||c,p),g=n?n+u:u;return c._events[g]?c._events[g].fn?c._events[g]=[c._events[g],b]:c._events[g].push(b):(c._events[g]=b,c._eventsCount++),c}i(o,"addListener");function a(c,u){--c._eventsCount===0?c._events=new s:delete c._events[u]}i(a,"clearEvent");function l(){this._events=new s,this._eventsCount=0}i(l,"EventEmitter"),l.prototype.eventNames=i(function(){var u=[],h,d;if(this._eventsCount===0)return u;for(d in h=this._events)e.call(h,d)&&u.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(h)):u},"eventNames"),l.prototype.listeners=i(function(u){var h=n?n+u:u,d=this._events[h];if(!d)return[];if(d.fn)return[d.fn];for(var p=0,b=d.length,g=new Array(b);p<b;p++)g[p]=d[p].fn;return g},"listeners"),l.prototype.listenerCount=i(function(u){var h=n?n+u:u,d=this._events[h];return d?d.fn?1:d.length:0},"listenerCount"),l.prototype.emit=i(function(u,h,d,p,b,g){var E=n?n+u:u;if(!this._events[E])return!1;var f=this._events[E],_=arguments.length,I,w;if(f.fn){switch(f.once&&this.removeListener(u,f.fn,void 0,!0),_){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,h),!0;case 3:return f.fn.call(f.context,h,d),!0;case 4:return f.fn.call(f.context,h,d,p),!0;case 5:return f.fn.call(f.context,h,d,p,b),!0;case 6:return f.fn.call(f.context,h,d,p,b,g),!0}for(w=1,I=new Array(_-1);w<_;w++)I[w-1]=arguments[w];f.fn.apply(f.context,I)}else{var Kt=f.length,k;for(w=0;w<Kt;w++)switch(f[w].once&&this.removeListener(u,f[w].fn,void 0,!0),_){case 1:f[w].fn.call(f[w].context);break;case 2:f[w].fn.call(f[w].context,h);break;case 3:f[w].fn.call(f[w].context,h,d);break;case 4:f[w].fn.call(f[w].context,h,d,p);break;default:if(!I)for(k=1,I=new Array(_-1);k<_;k++)I[k-1]=arguments[k];f[w].fn.apply(f[w].context,I)}}return!0},"emit"),l.prototype.on=i(function(u,h,d){return o(this,u,h,d,!1)},"on"),l.prototype.once=i(function(u,h,d){return o(this,u,h,d,!0)},"once"),l.prototype.removeListener=i(function(u,h,d,p){var b=n?n+u:u;if(!this._events[b])return this;if(!h)return a(this,b),this;var g=this._events[b];if(g.fn)g.fn===h&&(!p||g.once)&&(!d||g.context===d)&&a(this,b);else{for(var E=0,f=[],_=g.length;E<_;E++)(g[E].fn!==h||p&&!g[E].once||d&&g[E].context!==d)&&f.push(g[E]);f.length?this._events[b]=f.length===1?f[0]:f:a(this,b)}return this},"removeListener"),l.prototype.removeAllListeners=i(function(u){var h;return u?(h=n?n+u:u,this._events[h]&&a(this,h)):(this._events=new s,this._eventsCount=0),this},"removeAllListeners"),l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=n,l.EventEmitter=l,t.exports=l})(De);var Jt=De.exports;const $r=Gt(Jt);const mt=i(function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},"stringToByteArray$1"),Yt=i(function(t){const e=[];let n=0,s=0;for(;n<t.length;){const r=t[n++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const o=t[n++];e[s++]=String.fromCharCode((r&31)<<6|o&63)}else if(r>239&&r<365){const o=t[n++],a=t[n++],l=t[n++],c=((r&7)<<18|(o&63)<<12|(a&63)<<6|l&63)-65536;e[s++]=String.fromCharCode(55296+(c>>10)),e[s++]=String.fromCharCode(56320+(c&1023))}else{const o=t[n++],a=t[n++];e[s++]=String.fromCharCode((r&15)<<12|(o&63)<<6|a&63)}}return e.join("")},"byteArrayToString"),bt={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<t.length;r+=3){const o=t[r],a=r+1<t.length,l=a?t[r+1]:0,c=r+2<t.length,u=c?t[r+2]:0,h=o>>2,d=(o&3)<<4|l>>4;let p=(l&15)<<2|u>>6,b=u&63;c||(b=64,a||(p=64)),s.push(n[h],n[d],n[p],n[b])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(mt(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Yt(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<t.length;){const o=n[t.charAt(r++)],l=r<t.length?n[t.charAt(r)]:0;++r;const u=r<t.length?n[t.charAt(r)]:64;++r;const d=r<t.length?n[t.charAt(r)]:64;if(++r,o==null||l==null||u==null||d==null)throw new re;const p=o<<2|l>>4;if(s.push(p),u!==64){const b=l<<4&240|u>>2;if(s.push(b),d!==64){const g=u<<6&192|d;s.push(g)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},Fe=class Fe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}};i(Fe,"DecodeBase64StringError");let re=Fe;const Xt=i(function(t){const e=mt(t);return bt.encodeByteArray(e,!0)},"base64Encode"),wt=i(function(t){return Xt(t).replace(/\./g,"")},"base64urlEncodeWithoutPadding"),Zt=i(function(t){try{return bt.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null},"base64Decode");function Qt(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}i(Qt,"getGlobal");const en=i(()=>Qt().__FIREBASE_DEFAULTS__,"getDefaultsFromGlobal"),tn=i(()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},"getDefaultsFromEnvVariable"),nn=i(()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Zt(t[1]);return e&&JSON.parse(e)},"getDefaultsFromCookie"),sn=i(()=>{try{return en()||tn()||nn()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},"getDefaults"),_t=i(()=>{var t;return(t=sn())===null||t===void 0?void 0:t.config},"getDefaultAppConfig");const Re=class Re{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}};i(Re,"Deferred");let ie=Re;function Et(){try{return typeof indexedDB=="object"}catch{return!1}}i(Et,"isIndexedDBAvailable");function rn(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var o;e(((o=r.error)===null||o===void 0?void 0:o.message)||"")}}catch(n){e(n)}})}i(rn,"validateIndexedDBOpenable");const on="FirebaseError",W=class W extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=on,Object.setPrototypeOf(this,W.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,F.prototype.create)}};i(W,"FirebaseError");let D=W;const ke=class ke{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},r=`${this.service}/${e}`,o=this.errors[e],a=o?an(o,s):"Error",l=`${this.serviceName}: ${a} (${r}).`;return new D(r,l,s)}};i(ke,"ErrorFactory");let F=ke;function an(t,e){return t.replace(cn,(n,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}i(an,"replaceTemplate");const cn=/\{\$([^}]+)}/g;function oe(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const r of n){if(!s.includes(r))return!1;const o=t[r],a=e[r];if(tt(o)&&tt(a)){if(!oe(o,a))return!1}else if(o!==a)return!1}for(const r of s)if(!n.includes(r))return!1;return!0}i(oe,"deepEqual");function tt(t){return t!==null&&typeof t=="object"}i(tt,"isObject");const un=1e3,ln=2,hn=4*60*60*1e3,fn=.5;function dn(t,e=un,n=ln){const s=e*Math.pow(n,t),r=Math.round(fn*s*(Math.random()-.5)*2);return Math.min(hn,s+r)}i(dn,"calculateBackoffMillis");function P(t){return t&&t._delegate?t._delegate:t}i(P,"getModularInstance");const xe=class xe{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};i(xe,"Component");let v=xe;const M="[DEFAULT]";const je=class je{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new ie;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(o){if(r)return null;throw o}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(pn(e))try{this.getOrInitializeService({instanceIdentifier:M})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const o=this.getOrInitializeService({instanceIdentifier:r});s.resolve(o)}catch{}}}}clearInstance(e=M){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=M){return this.instances.has(e)}getOptions(e=M){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[o,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(o);s===l&&a.resolve(r)}return r}onInit(e,n){var s;const r=this.normalizeInstanceIdentifier(n),o=(s=this.onInitCallbacks.get(r))!==null&&s!==void 0?s:new Set;o.add(e),this.onInitCallbacks.set(r,o);const a=this.instances.get(r);return a&&e(a,r),()=>{o.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const r of s)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:gn(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=M){return this.component?this.component.multipleInstances?e:M:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};i(je,"Provider");let ae=je;function gn(t){return t===M?void 0:t}i(gn,"normalizeIdentifierForFactory");function pn(t){return t.instantiationMode==="EAGER"}i(pn,"isComponentEager");const Ve=class Ve{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new ae(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}};i(Ve,"ComponentContainer");let ce=Ve;var m;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(m||(m={}));const mn={debug:m.DEBUG,verbose:m.VERBOSE,info:m.INFO,warn:m.WARN,error:m.ERROR,silent:m.SILENT},bn=m.INFO,wn={[m.DEBUG]:"log",[m.VERBOSE]:"log",[m.INFO]:"info",[m.WARN]:"warn",[m.ERROR]:"error"},_n=i((t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),r=wn[e];if(r)console[r](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},"defaultLogHandler"),He=class He{constructor(e){this.name=e,this._logLevel=bn,this._logHandler=_n,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in m))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?mn[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,m.DEBUG,...e),this._logHandler(this,m.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,m.VERBOSE,...e),this._logHandler(this,m.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,m.INFO,...e),this._logHandler(this,m.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,m.WARN,...e),this._logHandler(this,m.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,m.ERROR,...e),this._logHandler(this,m.ERROR,...e)}};i(He,"Logger");let H=He;const En=i((t,e)=>e.some(n=>t instanceof n),"instanceOfAny$1");let nt,st;function yn(){return nt||(nt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}i(yn,"getIdbProxyableTypes$1");function In(){return st||(st=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}i(In,"getCursorAdvanceMethods$1");const yt=new WeakMap,ue=new WeakMap,It=new WeakMap,G=new WeakMap,Me=new WeakMap;function vn(t){const e=new Promise((n,s)=>{const r=i(()=>{t.removeEventListener("success",o),t.removeEventListener("error",a)},"unlisten"),o=i(()=>{n(S(t.result)),r()},"success"),a=i(()=>{s(t.error),r()},"error");t.addEventListener("success",o),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&yt.set(n,t)}).catch(()=>{}),Me.set(e,t),e}i(vn,"promisifyRequest$1");function Sn(t){if(ue.has(t))return;const e=new Promise((n,s)=>{const r=i(()=>{t.removeEventListener("complete",o),t.removeEventListener("error",a),t.removeEventListener("abort",a)},"unlisten"),o=i(()=>{n(),r()},"complete"),a=i(()=>{s(t.error||new DOMException("AbortError","AbortError")),r()},"error");t.addEventListener("complete",o),t.addEventListener("error",a),t.addEventListener("abort",a)});ue.set(t,e)}i(Sn,"cacheDonePromiseForTransaction$1");let le={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return ue.get(t);if(e==="objectStoreNames")return t.objectStoreNames||It.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return S(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Tn(t){le=t(le)}i(Tn,"replaceTraps$1");function Cn(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(J(this),e,...n);return It.set(s,e.sort?e.sort():[e]),S(s)}:In().includes(t)?function(...e){return t.apply(J(this),e),S(yt.get(this))}:function(...e){return S(t.apply(J(this),e))}}i(Cn,"wrapFunction$1");function An(t){return typeof t=="function"?Cn(t):(t instanceof IDBTransaction&&Sn(t),En(t,yn())?new Proxy(t,le):t)}i(An,"transformCachableValue$1");function S(t){if(t instanceof IDBRequest)return vn(t);if(G.has(t))return G.get(t);const e=An(t);return e!==t&&(G.set(t,e),Me.set(e,t)),e}i(S,"wrap$1");const J=i(t=>Me.get(t),"unwrap$1");function Dn(t,e,{blocked:n,upgrade:s,blocking:r,terminated:o}={}){const a=indexedDB.open(t,e),l=S(a);return s&&a.addEventListener("upgradeneeded",c=>{s(S(a.result),c.oldVersion,c.newVersion,S(a.transaction),c)}),n&&a.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{o&&c.addEventListener("close",()=>o()),r&&c.addEventListener("versionchange",u=>r(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}i(Dn,"openDB$1");const Mn=["get","getKey","getAll","getAllKeys","count"],On=["put","add","delete","clear"],Y=new Map;function rt(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Y.get(e))return Y.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,r=On.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(r||Mn.includes(n)))return;const o=i(async function(a,...l){const c=this.transaction(a,r?"readwrite":"readonly");let u=c.store;return s&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),r&&c.done]))[0]},"method");return Y.set(e,o),o}i(rt,"getMethod$1");Tn(t=>({...t,get:(e,n,s)=>rt(e,n)||t.get(e,n,s),has:(e,n)=>!!rt(e,n)||t.has(e,n)}));const Ue=class Ue{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Bn(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}};i(Ue,"PlatformLoggerServiceImpl");let he=Ue;function Bn(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}i(Bn,"isVersionServiceProvider");const fe="@firebase/app",it="0.9.20";const L=new H("@firebase/app"),Ln="@firebase/app-compat",Nn="@firebase/analytics-compat",$n="@firebase/analytics",Pn="@firebase/app-check-compat",Fn="@firebase/app-check",Rn="@firebase/auth",kn="@firebase/auth-compat",xn="@firebase/database",jn="@firebase/database-compat",Vn="@firebase/functions",Hn="@firebase/functions-compat",Un="@firebase/installations",zn="@firebase/installations-compat",Wn="@firebase/messaging",Kn="@firebase/messaging-compat",qn="@firebase/performance",Gn="@firebase/performance-compat",Jn="@firebase/remote-config",Yn="@firebase/remote-config-compat",Xn="@firebase/storage",Zn="@firebase/storage-compat",Qn="@firebase/firestore",es="@firebase/firestore-compat",ts="firebase",ns="10.5.0";const de="[DEFAULT]",ss={[fe]:"fire-core",[Ln]:"fire-core-compat",[$n]:"fire-analytics",[Nn]:"fire-analytics-compat",[Fn]:"fire-app-check",[Pn]:"fire-app-check-compat",[Rn]:"fire-auth",[kn]:"fire-auth-compat",[xn]:"fire-rtdb",[jn]:"fire-rtdb-compat",[Vn]:"fire-fn",[Hn]:"fire-fn-compat",[Un]:"fire-iid",[zn]:"fire-iid-compat",[Wn]:"fire-fcm",[Kn]:"fire-fcm-compat",[qn]:"fire-perf",[Gn]:"fire-perf-compat",[Jn]:"fire-rc",[Yn]:"fire-rc-compat",[Xn]:"fire-gcs",[Zn]:"fire-gcs-compat",[Qn]:"fire-fst",[es]:"fire-fst-compat","fire-js":"fire-js",[ts]:"fire-js-all"};const U=new Map,ge=new Map;function rs(t,e){try{t.container.addComponent(e)}catch(n){L.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}i(rs,"_addComponent");function R(t){const e=t.name;if(ge.has(e))return L.debug(`There were multiple attempts to register component ${e}.`),!1;ge.set(e,t);for(const n of U.values())rs(n,t);return!0}i(R,"_registerComponent");function Oe(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}i(Oe,"_getProvider");const is={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},T=new F("app","Firebase",is);const ze=class ze{constructor(e,n,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new v("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw T.create("app-deleted",{appName:this._name})}};i(ze,"FirebaseAppImpl");let pe=ze;const os=ns;function as(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s=Object.assign({name:de,automaticDataCollectionEnabled:!1},e),r=s.name;if(typeof r!="string"||!r)throw T.create("bad-app-name",{appName:String(r)});if(n||(n=_t()),!n)throw T.create("no-options");const o=U.get(r);if(o){if(oe(n,o.options)&&oe(s,o.config))return o;throw T.create("duplicate-app",{appName:r})}const a=new ce(r);for(const c of ge.values())a.addComponent(c);const l=new pe(n,s,a);return U.set(r,l),l}i(as,"initializeApp");function cs(t=de){const e=U.get(t);if(!e&&t===de&&_t())return as();if(!e)throw T.create("no-app",{appName:t});return e}i(cs,"getApp");function C(t,e,n){var s;let r=(s=ss[t])!==null&&s!==void 0?s:t;n&&(r+=`-${n}`);const o=r.match(/\s|\//),a=e.match(/\s|\//);if(o||a){const l=[`Unable to register library "${r}" with version "${e}":`];o&&l.push(`library name "${r}" contains illegal characters (whitespace or "/")`),o&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),L.warn(l.join(" "));return}R(new v(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}i(C,"registerVersion");const us="firebase-heartbeat-database",ls=1,j="firebase-heartbeat-store";let X=null;function vt(){return X||(X=Dn(us,ls,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(j)}}}).catch(t=>{throw T.create("idb-open",{originalErrorMessage:t.message})})),X}i(vt,"getDbPromise$1");async function hs(t){try{return await(await vt()).transaction(j).objectStore(j).get(St(t))}catch(e){if(e instanceof D)L.warn(e.message);else{const n=T.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});L.warn(n.message)}}}i(hs,"readHeartbeatsFromIndexedDB");async function ot(t,e){try{const s=(await vt()).transaction(j,"readwrite");await s.objectStore(j).put(e,St(t)),await s.done}catch(n){if(n instanceof D)L.warn(n.message);else{const s=T.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});L.warn(s.message)}}}i(ot,"writeHeartbeatsToIndexedDB");function St(t){return`${t.name}!${t.options.appId}`}i(St,"computeKey");const fs=1024,ds=30*24*60*60*1e3,We=class We{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new be(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=at();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(r=>r.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(r=>{const o=new Date(r.date).valueOf();return Date.now()-o<=ds}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=at(),{heartbeatsToSend:n,unsentEntries:s}=gs(this._heartbeatsCache.heartbeats),r=wt(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}};i(We,"HeartbeatServiceImpl");let me=We;function at(){return new Date().toISOString().substring(0,10)}i(at,"getUTCDateString");function gs(t,e=fs){const n=[];let s=t.slice();for(const r of t){const o=n.find(a=>a.agent===r.agent);if(o){if(o.dates.push(r.date),ct(n)>e){o.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),ct(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}i(gs,"extractHeartbeatsForHeader");const Ke=class Ke{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Et()?rn().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await hs(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return ot(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return ot(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}};i(Ke,"HeartbeatStorageImpl");let be=Ke;function ct(t){return wt(JSON.stringify({version:2,heartbeats:t})).length}i(ct,"countBytes");function ps(t){R(new v("platform-logger",e=>new he(e),"PRIVATE")),R(new v("heartbeat",e=>new me(e),"PRIVATE")),C(fe,it,t),C(fe,it,"esm2017"),C("fire-js","")}i(ps,"registerCoreComponents");ps("");var ms="firebase",bs="10.5.0";C(ms,bs,"app");const ws=i((t,e)=>e.some(n=>t instanceof n),"instanceOfAny");let ut,lt;function _s(){return ut||(ut=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}i(_s,"getIdbProxyableTypes");function Es(){return lt||(lt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}i(Es,"getCursorAdvanceMethods");const Tt=new WeakMap,we=new WeakMap,Ct=new WeakMap,Z=new WeakMap,Be=new WeakMap;function ys(t){const e=new Promise((n,s)=>{const r=i(()=>{t.removeEventListener("success",o),t.removeEventListener("error",a)},"unlisten"),o=i(()=>{n(A(t.result)),r()},"success"),a=i(()=>{s(t.error),r()},"error");t.addEventListener("success",o),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&Tt.set(n,t)}).catch(()=>{}),Be.set(e,t),e}i(ys,"promisifyRequest");function Is(t){if(we.has(t))return;const e=new Promise((n,s)=>{const r=i(()=>{t.removeEventListener("complete",o),t.removeEventListener("error",a),t.removeEventListener("abort",a)},"unlisten"),o=i(()=>{n(),r()},"complete"),a=i(()=>{s(t.error||new DOMException("AbortError","AbortError")),r()},"error");t.addEventListener("complete",o),t.addEventListener("error",a),t.addEventListener("abort",a)});we.set(t,e)}i(Is,"cacheDonePromiseForTransaction");let _e={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return we.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Ct.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return A(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function vs(t){_e=t(_e)}i(vs,"replaceTraps");function Ss(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(Q(this),e,...n);return Ct.set(s,e.sort?e.sort():[e]),A(s)}:Es().includes(t)?function(...e){return t.apply(Q(this),e),A(Tt.get(this))}:function(...e){return A(t.apply(Q(this),e))}}i(Ss,"wrapFunction");function Ts(t){return typeof t=="function"?Ss(t):(t instanceof IDBTransaction&&Is(t),ws(t,_s())?new Proxy(t,_e):t)}i(Ts,"transformCachableValue");function A(t){if(t instanceof IDBRequest)return ys(t);if(Z.has(t))return Z.get(t);const e=Ts(t);return e!==t&&(Z.set(t,e),Be.set(e,t)),e}i(A,"wrap");const Q=i(t=>Be.get(t),"unwrap");function Cs(t,e,{blocked:n,upgrade:s,blocking:r,terminated:o}={}){const a=indexedDB.open(t,e),l=A(a);return s&&a.addEventListener("upgradeneeded",c=>{s(A(a.result),c.oldVersion,c.newVersion,A(a.transaction))}),n&&a.addEventListener("blocked",()=>n()),l.then(c=>{o&&c.addEventListener("close",()=>o()),r&&c.addEventListener("versionchange",()=>r())}).catch(()=>{}),l}i(Cs,"openDB");const As=["get","getKey","getAll","getAllKeys","count"],Ds=["put","add","delete","clear"],ee=new Map;function ht(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(ee.get(e))return ee.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,r=Ds.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(r||As.includes(n)))return;const o=i(async function(a,...l){const c=this.transaction(a,r?"readwrite":"readonly");let u=c.store;return s&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),r&&c.done]))[0]},"method");return ee.set(e,o),o}i(ht,"getMethod");vs(t=>({...t,get:(e,n,s)=>ht(e,n)||t.get(e,n,s),has:(e,n)=>!!ht(e,n)||t.has(e,n)}));const At="@firebase/installations",Le="0.6.4";const Dt=1e4,Mt=`w:${Le}`,Ot="FIS_v2",Ms="https://firebaseinstallations.googleapis.com/v1",Os=60*60*1e3,Bs="installations",Ls="Installations";const Ns={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},N=new F(Bs,Ls,Ns);function Bt(t){return t instanceof D&&t.code.includes("request-failed")}i(Bt,"isServerError");function Lt({projectId:t}){return`${Ms}/projects/${t}/installations`}i(Lt,"getInstallationsEndpoint");function Nt(t){return{token:t.token,requestStatus:2,expiresIn:Ps(t.expiresIn),creationTime:Date.now()}}i(Nt,"extractAuthTokenInfoFromResponse");async function $t(t,e){const s=(await e.json()).error;return N.create("request-failed",{requestName:t,serverCode:s.code,serverMessage:s.message,serverStatus:s.status})}i($t,"getErrorFromResponse");function Pt({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}i(Pt,"getHeaders");function $s(t,{refreshToken:e}){const n=Pt(t);return n.append("Authorization",Fs(e)),n}i($s,"getHeadersWithAuth");async function Ft(t){const e=await t();return e.status>=500&&e.status<600?t():e}i(Ft,"retryIfServerError");function Ps(t){return Number(t.replace("s","000"))}i(Ps,"getExpiresInFromResponseExpiresIn");function Fs(t){return`${Ot} ${t}`}i(Fs,"getAuthorizationHeader");async function Rs({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const s=Lt(t),r=Pt(t),o=e.getImmediate({optional:!0});if(o){const u=await o.getHeartbeatsHeader();u&&r.append("x-firebase-client",u)}const a={fid:n,authVersion:Ot,appId:t.appId,sdkVersion:Mt},l={method:"POST",headers:r,body:JSON.stringify(a)},c=await Ft(()=>fetch(s,l));if(c.ok){const u=await c.json();return{fid:u.fid||n,registrationStatus:2,refreshToken:u.refreshToken,authToken:Nt(u.authToken)}}else throw await $t("Create Installation",c)}i(Rs,"createInstallationRequest");function Rt(t){return new Promise(e=>{setTimeout(e,t)})}i(Rt,"sleep");function ks(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}i(ks,"bufferToBase64UrlSafe");const xs=/^[cdef][\w-]{21}$/,Ee="";function js(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=Vs(t);return xs.test(n)?n:Ee}catch{return Ee}}i(js,"generateFid");function Vs(t){return ks(t).substr(0,22)}i(Vs,"encode");function K(t){return`${t.appName}!${t.appId}`}i(K,"getKey");const kt=new Map;function xt(t,e){const n=K(t);jt(n,e),Hs(n,e)}i(xt,"fidChanged");function jt(t,e){const n=kt.get(t);if(n)for(const s of n)s(e)}i(jt,"callFidChangeCallbacks");function Hs(t,e){const n=Us();n&&n.postMessage({key:t,fid:e}),zs()}i(Hs,"broadcastFidChange");let B=null;function Us(){return!B&&"BroadcastChannel"in self&&(B=new BroadcastChannel("[Firebase] FID Change"),B.onmessage=t=>{jt(t.data.key,t.data.fid)}),B}i(Us,"getBroadcastChannel");function zs(){kt.size===0&&B&&(B.close(),B=null)}i(zs,"closeBroadcastChannel");const Ws="firebase-installations-database",Ks=1,$="firebase-installations-store";let te=null;function Ne(){return te||(te=Cs(Ws,Ks,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore($)}}})),te}i(Ne,"getDbPromise");async function z(t,e){const n=K(t),r=(await Ne()).transaction($,"readwrite"),o=r.objectStore($),a=await o.get(n);return await o.put(e,n),await r.done,(!a||a.fid!==e.fid)&&xt(t,e.fid),e}i(z,"set");async function Vt(t){const e=K(t),s=(await Ne()).transaction($,"readwrite");await s.objectStore($).delete(e),await s.done}i(Vt,"remove");async function q(t,e){const n=K(t),r=(await Ne()).transaction($,"readwrite"),o=r.objectStore($),a=await o.get(n),l=e(a);return l===void 0?await o.delete(n):await o.put(l,n),await r.done,l&&(!a||a.fid!==l.fid)&&xt(t,l.fid),l}i(q,"update");async function $e(t){let e;const n=await q(t.appConfig,s=>{const r=qs(s),o=Gs(t,r);return e=o.registrationPromise,o.installationEntry});return n.fid===Ee?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}i($e,"getInstallationEntry");function qs(t){const e=t||{fid:js(),registrationStatus:0};return Ht(e)}i(qs,"updateOrCreateInstallationEntry");function Gs(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const r=Promise.reject(N.create("app-offline"));return{installationEntry:e,registrationPromise:r}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},s=Js(t,n);return{installationEntry:n,registrationPromise:s}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:Ys(t)}:{installationEntry:e}}i(Gs,"triggerRegistrationIfNecessary");async function Js(t,e){try{const n=await Rs(t,e);return z(t.appConfig,n)}catch(n){throw Bt(n)&&n.customData.serverCode===409?await Vt(t.appConfig):await z(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}i(Js,"registerInstallation");async function Ys(t){let e=await ft(t.appConfig);for(;e.registrationStatus===1;)await Rt(100),e=await ft(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:s}=await $e(t);return s||n}return e}i(Ys,"waitUntilFidRegistration");function ft(t){return q(t,e=>{if(!e)throw N.create("installation-not-found");return Ht(e)})}i(ft,"updateInstallationRequest");function Ht(t){return Xs(t)?{fid:t.fid,registrationStatus:0}:t}i(Ht,"clearTimedOutRequest");function Xs(t){return t.registrationStatus===1&&t.registrationTime+Dt<Date.now()}i(Xs,"hasInstallationRequestTimedOut");async function Zs({appConfig:t,heartbeatServiceProvider:e},n){const s=Qs(t,n),r=$s(t,n),o=e.getImmediate({optional:!0});if(o){const u=await o.getHeartbeatsHeader();u&&r.append("x-firebase-client",u)}const a={installation:{sdkVersion:Mt,appId:t.appId}},l={method:"POST",headers:r,body:JSON.stringify(a)},c=await Ft(()=>fetch(s,l));if(c.ok){const u=await c.json();return Nt(u)}else throw await $t("Generate Auth Token",c)}i(Zs,"generateAuthTokenRequest");function Qs(t,{fid:e}){return`${Lt(t)}/${e}/authTokens:generate`}i(Qs,"getGenerateAuthTokenEndpoint");async function Pe(t,e=!1){let n;const s=await q(t.appConfig,o=>{if(!Ut(o))throw N.create("not-registered");const a=o.authToken;if(!e&&nr(a))return o;if(a.requestStatus===1)return n=er(t,e),o;{if(!navigator.onLine)throw N.create("app-offline");const l=rr(o);return n=tr(t,l),l}});return n?await n:s.authToken}i(Pe,"refreshAuthToken");async function er(t,e){let n=await dt(t.appConfig);for(;n.authToken.requestStatus===1;)await Rt(100),n=await dt(t.appConfig);const s=n.authToken;return s.requestStatus===0?Pe(t,e):s}i(er,"waitUntilAuthTokenRequest");function dt(t){return q(t,e=>{if(!Ut(e))throw N.create("not-registered");const n=e.authToken;return ir(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}i(dt,"updateAuthTokenRequest");async function tr(t,e){try{const n=await Zs(t,e),s=Object.assign(Object.assign({},e),{authToken:n});return await z(t.appConfig,s),n}catch(n){if(Bt(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await Vt(t.appConfig);else{const s=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await z(t.appConfig,s)}throw n}}i(tr,"fetchAuthTokenFromServer");function Ut(t){return t!==void 0&&t.registrationStatus===2}i(Ut,"isEntryRegistered");function nr(t){return t.requestStatus===2&&!sr(t)}i(nr,"isAuthTokenValid");function sr(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+Os}i(sr,"isAuthTokenExpired");function rr(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}i(rr,"makeAuthTokenRequestInProgressEntry");function ir(t){return t.requestStatus===1&&t.requestTime+Dt<Date.now()}i(ir,"hasAuthTokenRequestTimedOut");async function or(t){const e=t,{installationEntry:n,registrationPromise:s}=await $e(e);return s?s.catch(console.error):Pe(e).catch(console.error),n.fid}i(or,"getId");async function ar(t,e=!1){const n=t;return await cr(n),(await Pe(n,e)).token}i(ar,"getToken");async function cr(t){const{registrationPromise:e}=await $e(t);e&&await e}i(cr,"completeInstallationRegistration");function ur(t){if(!t||!t.options)throw ne("App Configuration");if(!t.name)throw ne("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw ne(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}i(ur,"extractAppConfig");function ne(t){return N.create("missing-app-config-values",{valueName:t})}i(ne,"getMissingValueError");const zt="installations",lr="installations-internal",hr=i(t=>{const e=t.getProvider("app").getImmediate(),n=ur(e),s=Oe(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:s,_delete:()=>Promise.resolve()}},"publicFactory"),fr=i(t=>{const e=t.getProvider("app").getImmediate(),n=Oe(e,zt).getImmediate();return{getId:()=>or(n),getToken:r=>ar(n,r)}},"internalFactory");function dr(){R(new v(zt,hr,"PUBLIC")),R(new v(lr,fr,"PRIVATE"))}i(dr,"registerInstallations");dr();C(At,Le);C(At,Le,"esm2017");const se="@firebase/remote-config",gt="0.4.4";const qe=class qe{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}};i(qe,"RemoteConfigAbortSignal");let ye=qe;const Wt="remote-config";const gr={"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"},y=new F("remoteconfig","Remote Config",gr);function pr(t,e){return t instanceof D&&t.code.indexOf(e)!==-1}i(pr,"hasErrorCode");const mr=!1,br="",pt=0,wr=["1","true","t","yes","y","on"],Ge=class Ge{constructor(e,n=br){this._source=e,this._value=n}asString(){return this._value}asBoolean(){return this._source==="static"?mr:wr.indexOf(this._value.toLowerCase())>=0}asNumber(){if(this._source==="static")return pt;let e=Number(this._value);return isNaN(e)&&(e=pt),e}getSource(){return this._source}};i(Ge,"Value");let x=Ge;function Pr(t=cs()){return t=P(t),Oe(t,Wt).getImmediate()}i(Pr,"getRemoteConfig");async function _r(t){const e=P(t),[n,s]=await Promise.all([e._storage.getLastSuccessfulFetchResponse(),e._storage.getActiveConfigEtag()]);return!n||!n.config||!n.eTag||n.eTag===s?!1:(await Promise.all([e._storageCache.setActiveConfig(n.config),e._storage.setActiveConfigEtag(n.eTag)]),!0)}i(_r,"activate");function Er(t){const e=P(t);return e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0})),e._initializePromise}i(Er,"ensureInitialized");async function yr(t){const e=P(t),n=new ye;setTimeout(async()=>{n.abort()},e.settings.fetchTimeoutMillis);try{await e._client.fetch({cacheMaxAgeMillis:e.settings.minimumFetchIntervalMillis,signal:n}),await e._storageCache.setLastFetchStatus("success")}catch(s){const r=pr(s,"fetch-throttle")?"throttle":"failure";throw await e._storageCache.setLastFetchStatus(r),s}}i(yr,"fetchConfig");function Fr(t,e){return Ir(P(t),e).asString()}i(Fr,"getString");function Ir(t,e){const n=P(t);n._isInitializationComplete||n._logger.debug(`A value was requested for key "${e}" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.`);const s=n._storageCache.getActiveConfig();return s&&s[e]!==void 0?new x("remote",s[e]):n.defaultConfig&&n.defaultConfig[e]!==void 0?new x("default",String(n.defaultConfig[e])):(n._logger.debug(`Returning static value for key "${e}". Define a default or remote value if this is unintentional.`),new x("static"))}i(Ir,"getValue");const Je=class Je{constructor(e,n,s,r){this.client=e,this.storage=n,this.storageCache=s,this.logger=r}isCachedDataFresh(e,n){if(!n)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const s=Date.now()-n,r=s<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${s}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${r}.`),r}async fetch(e){const[n,s]=await Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()]);if(s&&this.isCachedDataFresh(e.cacheMaxAgeMillis,n))return s;e.eTag=s&&s.eTag;const r=await this.client.fetch(e),o=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return r.status===200&&o.push(this.storage.setLastSuccessfulFetchResponse(r)),await Promise.all(o),r}};i(Je,"CachingClient");let Ie=Je;function vr(t=navigator){return t.languages&&t.languages[0]||t.language}i(vr,"getUserLanguage");const Ye=class Ye{constructor(e,n,s,r,o,a){this.firebaseInstallations=e,this.sdkVersion=n,this.namespace=s,this.projectId=r,this.apiKey=o,this.appId=a}async fetch(e){const[n,s]=await Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()]),o=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${this.projectId}/namespaces/${this.namespace}:fetch?key=${this.apiKey}`,a={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},l={sdk_version:this.sdkVersion,app_instance_id:n,app_instance_id_token:s,app_id:this.appId,language_code:vr()},c={method:"POST",headers:a,body:JSON.stringify(l)},u=fetch(o,c),h=new Promise((f,_)=>{e.signal.addEventListener(()=>{const I=new Error("The operation was aborted.");I.name="AbortError",_(I)})});let d;try{await Promise.race([u,h]),d=await u}catch(f){let _="fetch-client-network";throw(f==null?void 0:f.name)==="AbortError"&&(_="fetch-timeout"),y.create(_,{originalErrorMessage:f==null?void 0:f.message})}let p=d.status;const b=d.headers.get("ETag")||void 0;let g,E;if(d.status===200){let f;try{f=await d.json()}catch(_){throw y.create("fetch-client-parse",{originalErrorMessage:_==null?void 0:_.message})}g=f.entries,E=f.state}if(E==="INSTANCE_STATE_UNSPECIFIED"?p=500:E==="NO_CHANGE"?p=304:(E==="NO_TEMPLATE"||E==="EMPTY_CONFIG")&&(g={}),p!==304&&p!==200)throw y.create("fetch-status",{httpStatus:p});return{status:p,eTag:b,config:g}}};i(Ye,"RestClient");let ve=Ye;function Sr(t,e){return new Promise((n,s)=>{const r=Math.max(e-Date.now(),0),o=setTimeout(n,r);t.addEventListener(()=>{clearTimeout(o),s(y.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}i(Sr,"setAbortableTimeout");function Tr(t){if(!(t instanceof D)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}i(Tr,"isRetriableError");const Xe=class Xe{constructor(e,n){this.client=e,this.storage=n}async fetch(e){const n=await this.storage.getThrottleMetadata()||{backoffCount:0,throttleEndTimeMillis:Date.now()};return this.attemptFetch(e,n)}async attemptFetch(e,{throttleEndTimeMillis:n,backoffCount:s}){await Sr(e.signal,n);try{const r=await this.client.fetch(e);return await this.storage.deleteThrottleMetadata(),r}catch(r){if(!Tr(r))throw r;const o={throttleEndTimeMillis:Date.now()+dn(s),backoffCount:s+1};return await this.storage.setThrottleMetadata(o),this.attemptFetch(e,o)}}};i(Xe,"RetryingClient");let Se=Xe;const Cr=60*1e3,Ar=12*60*60*1e3,Ze=class Ze{constructor(e,n,s,r,o){this.app=e,this._client=n,this._storageCache=s,this._storage=r,this._logger=o,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:Cr,minimumFetchIntervalMillis:Ar},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}};i(Ze,"RemoteConfig");let Te=Ze;function V(t,e){const n=t.target.error||void 0;return y.create(e,{originalErrorMessage:n&&(n==null?void 0:n.message)})}i(V,"toFirebaseError");const O="app_namespace_store",Dr="firebase_remote_config",Mr=1;function Or(){return new Promise((t,e)=>{try{const n=indexedDB.open(Dr,Mr);n.onerror=s=>{e(V(s,"storage-open"))},n.onsuccess=s=>{t(s.target.result)},n.onupgradeneeded=s=>{const r=s.target.result;switch(s.oldVersion){case 0:r.createObjectStore(O,{keyPath:"compositeKey"})}}}catch(n){e(y.create("storage-open",{originalErrorMessage:n==null?void 0:n.message}))}})}i(Or,"openDatabase");const Qe=class Qe{constructor(e,n,s,r=Or()){this.appId=e,this.appName=n,this.namespace=s,this.openDbPromise=r}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}async get(e){const n=await this.openDbPromise;return new Promise((s,r)=>{const a=n.transaction([O],"readonly").objectStore(O),l=this.createCompositeKey(e);try{const c=a.get(l);c.onerror=u=>{r(V(u,"storage-get"))},c.onsuccess=u=>{const h=u.target.result;s(h?h.value:void 0)}}catch(c){r(y.create("storage-get",{originalErrorMessage:c==null?void 0:c.message}))}})}async set(e,n){const s=await this.openDbPromise;return new Promise((r,o)=>{const l=s.transaction([O],"readwrite").objectStore(O),c=this.createCompositeKey(e);try{const u=l.put({compositeKey:c,value:n});u.onerror=h=>{o(V(h,"storage-set"))},u.onsuccess=()=>{r()}}catch(u){o(y.create("storage-set",{originalErrorMessage:u==null?void 0:u.message}))}})}async delete(e){const n=await this.openDbPromise;return new Promise((s,r)=>{const a=n.transaction([O],"readwrite").objectStore(O),l=this.createCompositeKey(e);try{const c=a.delete(l);c.onerror=u=>{r(V(u,"storage-delete"))},c.onsuccess=()=>{s()}}catch(c){r(y.create("storage-delete",{originalErrorMessage:c==null?void 0:c.message}))}})}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}};i(Qe,"Storage");let Ce=Qe;const et=class et{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}async loadFromStorage(){const e=this.storage.getLastFetchStatus(),n=this.storage.getLastSuccessfulFetchTimestampMillis(),s=this.storage.getActiveConfig(),r=await e;r&&(this.lastFetchStatus=r);const o=await n;o&&(this.lastSuccessfulFetchTimestampMillis=o);const a=await s;a&&(this.activeConfig=a)}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}};i(et,"StorageCache");let Ae=et;function Br(){R(new v(Wt,t,"PUBLIC").setMultipleInstances(!0)),C(se,gt),C(se,gt,"esm2017");function t(e,{instanceIdentifier:n}){const s=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw y.create("registration-window");if(!Et())throw y.create("indexed-db-unavailable");const{projectId:o,apiKey:a,appId:l}=s.options;if(!o)throw y.create("registration-project-id");if(!a)throw y.create("registration-api-key");if(!l)throw y.create("registration-app-id");n=n||"firebase";const c=new Ce(l,s.name,n),u=new Ae(c),h=new H(se);h.logLevel=m.ERROR;const d=new ve(r,os,n,o,a,l),p=new Se(d,c),b=new Ie(p,c,u,h),g=new Te(s,b,u,c,h);return Er(g),g}i(t,"remoteConfigFactory")}i(Br,"registerRemoteConfig");async function Rr(t){return t=P(t),await yr(t),_r(t)}i(Rr,"fetchAndActivate");Br();export{$r as E,Fr as a,Rr as f,Pr as g,as as i};
